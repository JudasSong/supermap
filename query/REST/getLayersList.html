<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
 <HEAD>
  <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
  <TITLE>getLayersList</TITLE>
  <script  type="text/javascript" src="json_parse.js"></script>
  <script  type="text/javascript" src="toJSON.js"></script>
 </HEAD>

 <BODY>
    <input type="button" name="Submit" value="Test" onclick="getLayersList()" />
    <br><br>
    <div align=left id="container" style="left:50px;top:50px"></div>
 </BODY>
 <script  type="text/javascript">
	//示例代码添加的地方
	//获取China地图的图层列表
	function getLayersList()
	{
		var commit=getcommit();
		var uri="http://support.supermap.com.cn:8090/iserver/services/map-china400/rest/maps/China_4326/layers.json";
		
		commit.open("GET",encodeURI(uri),false,"","");
		commit.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8");
		commit.send(null);
		
		//解析从服务器端返回的json字符串，解析为一个JavaScript对象。
		var response = json_parse(commit.responseText, null);       
		//获取用作显示的Div容器。
		var container = document.getElementById('container');
		//输出结果  
		//China中图层的数目
		var len=response.length;
		container.innerHTML="China地图里的图层有"+len+"个，分别为：";
		for(var i=0;i<len;i++)
		{
			container.innerHTML += '<li>图层名：' + response[i].name + '，图层类型：' + response[i].type+'</li>';
						container.innerHTML +='<br><p>图层'+response[i].name+'的子图层有：</p>'
			//第i个图层的子图层的数目
			//subLayers可能为空，里面根本没有layers字段。
			len1=response[i].subLayers.layers.length;
			//alert(len1);
			for(var j=0;j<len1;j++)
			{
				container.innerHTML += '<li>'+response[i].subLayers.layers[j].name+'</li>' ;
			}
			container.innerHTML +='</ol>';
			
		}   
	}
 </script>
</HTML>
